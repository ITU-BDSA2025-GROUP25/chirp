@page "/{author}"
@model Chirp.Razor.Pages.UserTimelineModel
@{
    ViewData["Title"] = "Chirp!";
    Layout = "Shared/_Layout";
    var routeName = HttpContext.GetRouteValue("author")?.ToString();
}

<div>
    <h2>@Model.TimelineDisplayName's Timeline</h2>

    @if (Model.Cheeps.Any())
    {
        <ul id="messagelist" class="cheeps">
            @foreach (var cheep in Model.Cheeps)
            {
                <li>
                    <p>
                        <strong>
                            <a href="/@cheep.AuthorKey">@cheep.AuthorDisplayName</a>
                        </strong>
                        @cheep.Message
                        <small>&mdash; @cheep.Timestamp</small>
                    </p>
                </li>
            }
        </ul>

        <div style="margin-top:20px; display:flex; align-items:center; gap:12px;">
            @if (Model.CurrentPage > 1)
            {
                <form method="get" action="/@routeName" style="margin:0;">
                    <input type="hidden" name="page" value="@(Model.CurrentPage - 1)"/>
                    <button type="submit" class="btn btn-secondary">⬅ Previous</button>
                </form>
            }

            <span>Page @Model.CurrentPage</span>

            @if (Model.HasMorePages)
            {
                <form method="get" action="/@routeName" style="margin:0;">
                    <input type="hidden" name="page" value="@(Model.CurrentPage + 1)"/>
                    <button type="submit" class="btn btn-primary">Next ➡</button>
                </form>
            }
        </div>
    }
    else
    {
        <em>There are no cheeps so far.</em>
    }
</div>